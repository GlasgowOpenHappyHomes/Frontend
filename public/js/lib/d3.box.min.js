(function(){function e(e){return[0,e.length-1]}function t(e){return[d3.quantile(e,.25),d3.quantile(e,.5),d3.quantile(e,.75)]}d3.box=function(){function l(e){e.each(function(e,t){e=e.map(o).sort(d3.ascending);var f=d3.select(this),l=e.length,c=e[0],h=e[l-1];var p=e.quartiles=a(e);var d=u&&u.call(this,e,t),v=d&&d.map(function(t){return e[t]});var m=d?d3.range(0,d[0]).concat(d3.range(d[1]+1,l)):d3.range(l);var g=d3.scale.linear().domain(s&&s.call(this,e,t)||[c,h]).range([r,0]);var y=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(g.range());this.__chart__=g;var b=f.selectAll("line.center").data(v?[v]:[]);b.enter().insert("line","rect").attr("class","center").attr("x1",n/2).attr("y1",function(e){return y(e[0])}).attr("x2",n/2).attr("y2",function(e){return y(e[1])}).style("opacity",1e-6).transition().duration(i).style("opacity",1).attr("y1",function(e){return g(e[0])}).attr("y2",function(e){return g(e[1])});b.transition().duration(i).style("opacity",1).attr("y1",function(e){return g(e[0])}).attr("y2",function(e){return g(e[1])});b.exit().transition().duration(i).style("opacity",1e-6).attr("y1",function(e){return g(e[0])}).attr("y2",function(e){return g(e[1])}).remove();var w=f.selectAll("rect.box").data([p]);w.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(e){return y(e[2])}).attr("width",n).attr("height",function(e){return y(e[0])-y(e[2])}).transition().duration(i).attr("y",function(e){return g(e[2])}).attr("height",function(e){return g(e[0])-g(e[2])});w.transition().duration(i).attr("y",function(e){return g(e[2])}).attr("height",function(e){return g(e[0])-g(e[2])});var E=f.selectAll("line.median").data([p[1]]);E.enter().append("line").attr("class","median").attr("x1",0).attr("y1",y).attr("x2",n).attr("y2",y).transition().duration(i).attr("y1",g).attr("y2",g);E.transition().duration(i).attr("y1",g).attr("y2",g);var S=f.selectAll("line.whisker").data(v||[]);S.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",y).attr("x2",n).attr("y2",y).style("opacity",1e-6).transition().duration(i).attr("y1",g).attr("y2",g).style("opacity",1);S.transition().duration(i).attr("y1",g).attr("y2",g).style("opacity",1);S.exit().transition().duration(i).attr("y1",g).attr("y2",g).style("opacity",1e-6).remove();var x=f.selectAll("circle.outlier").data(m,Number);x.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",n/2).attr("cy",function(t){return y(e[t])}).style("opacity",1e-6).transition().duration(i).attr("cy",function(t){return g(e[t])}).style("opacity",1);x.transition().duration(i).attr("cy",function(t){return g(e[t])}).style("opacity",1);x.exit().transition().duration(i).attr("cy",function(t){return g(e[t])}).style("opacity",1e-6).remove();var T=d3.format(".1f");var N=f.selectAll("text.box").data(p);N.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(e,t){return t&1?6:-6}).attr("x",function(e,t){return t&1?n:0}).attr("y",y).attr("text-anchor",function(e,t){return t&1?"start":"end"}).text(T).transition().duration(i).attr("y",g);N.transition().duration(i).text(T).attr("y",g);var C=f.selectAll("text.whisker").data(v||[]);C.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",n).attr("y",y).text(T).style("opacity",1e-6).transition().duration(i).attr("y",g).style("opacity",1);C.transition().duration(i).text(T).attr("y",g).style("opacity",1);C.exit().transition().duration(i).attr("y",g).style("opacity",1e-6).remove()});d3.timer.flush()}var n=1,r=1,i=0,s=null,o=Number,u=e,a=t,f=null;l.width=function(e){if(!arguments.length)return n;n=e;return l};l.height=function(e){if(!arguments.length)return r;r=e;return l};l.tickFormat=function(e){if(!arguments.length)return f;f=e;return l};l.duration=function(e){if(!arguments.length)return i;i=e;return l};l.domain=function(e){if(!arguments.length)return s;s=e==null?e:d3.functor(e);return l};l.value=function(e){if(!arguments.length)return o;o=e;return l};l.whiskers=function(e){if(!arguments.length)return u;u=e;return l};l.quartiles=function(e){if(!arguments.length)return a;a=e;return l};return l}})()